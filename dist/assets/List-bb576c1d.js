import{_ as X,r as i,h as Z,b as u,i as ee,o as z,c as le,d as e,w as a,E as b,e as N,g as v,f as ae,m as te,n as oe,t as ne,q as se}from"./main-5d00e0ed.js";import{g as ue,u as de,a as re,d as ie}from"./driver-efd12400.js";const pe={class:"driver-list"},me={class:"card-header"},ve={class:"dialog-footer"},ce={__name:"List",setup(fe){const y=i(!1),x=i([]),T=i(0),c=i(!1),V=i(""),w=i(!1),p=i(null),n=i({page:1,size:10,name:void 0,status:void 0}),s=i({id:void 0,name:"",employeeNo:"",phone:"",licenseNo:"",licenseType:"",licenseExpire:""}),R={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],licenseNo:[{required:!0,message:"请输入驾驶证号",trigger:"blur"}]},C=i(null),f=async()=>{y.value=!0;try{const t=await ue(n.value.page,n.value.size,n.value.name,n.value.status);x.value=t.data.list,T.value=t.data.total}catch(t){console.error(t),b.error("获取驾驶员列表失败")}finally{y.value=!1}},E=()=>{n.value.page=1,f()},h=()=>{n.value={page:1,size:10,name:void 0,status:void 0},E()},A=t=>{n.value.size=t,f()},B=t=>{n.value.page=t,f()},I=()=>{V.value="新增驾驶员",w.value=!1,c.value=!0},S=t=>{V.value="编辑驾驶员",w.value=!0,s.value={...t},c.value=!0},U=async t=>{try{await se.confirm(`确定要删除驾驶员 ${t.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ie(t.id),b.success("删除成功"),f()}catch(l){l!=="cancel"&&b.error("删除失败")}},L=async()=>{await C.value.validate(t=>{t&&(w.value?de(s.value.id,s.value).then(()=>{b.success("修改成功"),c.value=!1,f()}):re(s.value).then(()=>{b.success("新增成功"),c.value=!1,f()}))})},O=()=>{var t;(t=C.value)==null||t.resetFields()},q=t=>({ACTIVE:"success",ON_TRIP:"primary",ON_LEAVE:"warning",RESIGNED:"danger"})[t]||"info",M=t=>({ACTIVE:"正常",ON_TRIP:"已出车",ON_LEAVE:"休假",RESIGNED:"离职"})[t]||"未知",P=t=>{p.value=t},Y=({row:t})=>p.value&&p.value.id===t.id?"selected-row":"",G=()=>{p.value&&S(p.value)},F=()=>{p.value&&U(p.value)};return Z(()=>{f()}),(t,l)=>{const _=u("el-button"),g=u("el-input"),d=u("el-form-item"),r=u("el-option"),D=u("el-select"),k=u("el-form"),m=u("el-table-column"),K=u("el-tag"),Q=u("el-table"),$=u("el-pagination"),j=u("el-card"),H=u("el-date-picker"),J=u("el-dialog"),W=ee("loading");return z(),le("div",pe,[e(j,null,{header:a(()=>[N("div",me,[l[13]||(l[13]=N("h3",null,"驾驶员档案管理",-1)),e(_,{type:"primary",onClick:I},{default:a(()=>[...l[12]||(l[12]=[v("新增驾驶员",-1)])]),_:1})])]),default:a(()=>[e(k,{model:n.value,inline:""},{default:a(()=>[e(d,{label:"姓名"},{default:a(()=>[e(g,{modelValue:n.value.name,"onUpdate:modelValue":l[0]||(l[0]=o=>n.value.name=o),placeholder:"请输入驾驶员姓名",clearable:"",onKeyup:ae(E,["enter"])},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:a(()=>[e(D,{modelValue:n.value.status,"onUpdate:modelValue":l[1]||(l[1]=o=>n.value.status=o),placeholder:"请选择状态",clearable:""},{default:a(()=>[e(r,{label:"正常",value:"ACTIVE"}),e(r,{label:"已出车",value:"ON_TRIP"}),e(r,{label:"休假",value:"ON_LEAVE"}),e(r,{label:"离职",value:"RESIGNED"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(_,{type:"primary",onClick:E},{default:a(()=>[...l[14]||(l[14]=[v("搜索",-1)])]),_:1}),e(_,{onClick:h},{default:a(()=>[...l[15]||(l[15]=[v("重置",-1)])]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(_,{type:"primary",onClick:G,disabled:!p.value},{default:a(()=>[...l[16]||(l[16]=[v(" 编辑 ",-1)])]),_:1},8,["disabled"]),e(_,{type:"danger",onClick:F,disabled:!p.value},{default:a(()=>[...l[17]||(l[17]=[v(" 删除 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"]),te((z(),oe(Q,{data:x.value,style:{width:"100%"},onRowClick:P,"row-class-name":Y},{default:a(()=>[e(m,{prop:"id",label:"ID",width:"80"}),e(m,{prop:"name",label:"姓名",width:"100"}),e(m,{prop:"employeeNo",label:"工号",width:"120"}),e(m,{prop:"phone",label:"联系电话",width:"120"}),e(m,{prop:"licenseNo",label:"驾驶证号",width:"180"}),e(m,{prop:"licenseType",label:"准驾车型",width:"100"}),e(m,{prop:"licenseExpire",label:"驾照有效期",width:"120"}),e(m,{prop:"status",label:"状态",width:"100"},{default:a(o=>[e(K,{type:q(o.row.status)},{default:a(()=>[v(ne(M(o.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"createdAt",label:"创建时间",width:"160"})]),_:1},8,["data"])),[[W,y.value]]),e($,{"current-page":n.value.page,"onUpdate:currentPage":l[2]||(l[2]=o=>n.value.page=o),"page-size":n.value.size,"onUpdate:pageSize":l[3]||(l[3]=o=>n.value.size=o),"page-sizes":[10,20,50,100],total:T.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:A,onCurrentChange:B,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1}),e(J,{title:V.value,modelValue:c.value,"onUpdate:modelValue":l[11]||(l[11]=o=>c.value=o),width:"600px",onClose:O},{footer:a(()=>[N("div",ve,[e(_,{onClick:l[10]||(l[10]=o=>c.value=!1)},{default:a(()=>[...l[18]||(l[18]=[v("取 消",-1)])]),_:1}),e(_,{type:"primary",onClick:L},{default:a(()=>[...l[19]||(l[19]=[v("确 定",-1)])]),_:1})])]),default:a(()=>[e(k,{model:s.value,rules:R,ref_key:"formRef",ref:C,"label-width":"100px"},{default:a(()=>[e(d,{label:"姓名",prop:"name"},{default:a(()=>[e(g,{modelValue:s.value.name,"onUpdate:modelValue":l[4]||(l[4]=o=>s.value.name=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"工号",prop:"employeeNo"},{default:a(()=>[e(g,{modelValue:s.value.employeeNo,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value.employeeNo=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"联系电话",prop:"phone"},{default:a(()=>[e(g,{modelValue:s.value.phone,"onUpdate:modelValue":l[6]||(l[6]=o=>s.value.phone=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"驾驶证号",prop:"licenseNo"},{default:a(()=>[e(g,{modelValue:s.value.licenseNo,"onUpdate:modelValue":l[7]||(l[7]=o=>s.value.licenseNo=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"准驾车型",prop:"licenseType"},{default:a(()=>[e(D,{modelValue:s.value.licenseType,"onUpdate:modelValue":l[8]||(l[8]=o=>s.value.licenseType=o),placeholder:"请选择准驾车型"},{default:a(()=>[e(r,{label:"A1",value:"A1"}),e(r,{label:"A2",value:"A2"}),e(r,{label:"B1",value:"B1"}),e(r,{label:"B2",value:"B2"}),e(r,{label:"C1",value:"C1"}),e(r,{label:"C2",value:"C2"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"驾照有效期",prop:"licenseExpire"},{default:a(()=>[e(H,{modelValue:s.value.licenseExpire,"onUpdate:modelValue":l[9]||(l[9]=o=>s.value.licenseExpire=o),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},be=X(ce,[["__scopeId","data-v-2857a21d"]]);export{be as default};
