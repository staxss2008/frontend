import{_ as W,r as m,b as X,e as s,f as Z,o as z,c as ee,g as e,w as t,a as T,h as v,q as le,i as ae,k as te,t as oe,s as ue,E as N}from"./main-95657814.js";import{s as w}from"./request-a1c3ad29.js";function ne(f,p,y,V){return w({url:"/api/vehicle/list",method:"get",params:{page:f,size:p,plateNo:y,status:V}})}function se(f){return w({url:"/api/vehicle/add",method:"post",data:f})}function de(f,p){return w({url:`/api/vehicle/update/${f}`,method:"put",data:p})}function ie(f,p){return w({url:`/api/vehicle/update-status/${f}`,method:"put",params:{status:p}})}const re={class:"vehicle-list"},pe={class:"card-header"},me={class:"dialog-footer"},ve={__name:"List",setup(f){const p=m(!1),y=m([]),V=m(0),b=m(!1),E=m(""),C=m(!1),n=m({page:1,size:10,plateNo:void 0,status:void 0}),o=m({id:void 0,plateNo:"",vehicleType:"",brand:"",model:"",color:"",seats:5,fuelType:"",buyDate:"",gpsDeviceId:""}),S={plateNo:[{required:!0,message:"请输入车牌号",trigger:"blur"}],vehicleType:[{required:!0,message:"请输入车辆类型",trigger:"blur"}]},I=m(null),g=async()=>{p.value=!0;try{const u=await ne(n.value.page,n.value.size,n.value.plateNo,n.value.status);y.value=u.data.list,V.value=u.data.total}catch(u){console.error(u)}finally{p.value=!1}},D=()=>{n.value.page=1,g()},A=()=>{n.value={page:1,size:10,plateNo:void 0,status:void 0},D()},B=u=>{n.value.size=u,g()},M=u=>{n.value.page=u,g()},F=()=>{E.value="新增车辆",C.value=!1,b.value=!0},Y=u=>{E.value="编辑车辆",C.value=!0,o.value={...u},b.value=!0},h=async(u,l)=>{try{await ue.confirm(`确定要将车辆 ${u.plateNo} 的状态更新为 ${k(l)} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ie(u.id,l),N.success("状态更新成功"),g()}catch(r){r!=="cancel"&&N.error("状态更新失败")}},$=async()=>{await I.value.validate(u=>{u&&(C.value?de(o.value.id,o.value).then(()=>{N.success("修改成功"),b.value=!1,g()}):se(o.value).then(()=>{N.success("新增成功"),b.value=!1,g()}))})},R=()=>{var u;(u=I.value)==null||u.resetFields()},q=u=>({IDLE:"success",BUSY:"warning",OFFLINE:"info",MAINTENANCE:"danger"})[u]||"info",k=u=>({IDLE:"空闲",BUSY:"使用中",OFFLINE:"离线",MAINTENANCE:"维修中"})[u]||"未知";return X(()=>{g()}),(u,l)=>{const r=s("el-button"),_=s("el-input"),d=s("el-form-item"),c=s("el-option"),U=s("el-select"),x=s("el-form"),i=s("el-table-column"),O=s("el-tag"),P=s("el-table"),G=s("el-pagination"),K=s("el-card"),Q=s("el-input-number"),j=s("el-date-picker"),H=s("el-dialog"),J=Z("loading");return z(),ee("div",re,[e(K,null,{header:t(()=>[T("div",pe,[l[16]||(l[16]=T("h3",null,"车辆档案管理",-1)),e(r,{type:"primary",onClick:F},{default:t(()=>[...l[15]||(l[15]=[v("新增车辆",-1)])]),_:1})])]),default:t(()=>[e(x,{model:n.value,inline:""},{default:t(()=>[e(d,{label:"车牌号"},{default:t(()=>[e(_,{modelValue:n.value.plateNo,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value.plateNo=a),placeholder:"请输入车牌号",clearable:"",onKeyup:le(D,["enter"])},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:t(()=>[e(U,{modelValue:n.value.status,"onUpdate:modelValue":l[1]||(l[1]=a=>n.value.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(c,{label:"空闲",value:"IDLE"}),e(c,{label:"使用中",value:"BUSY"}),e(c,{label:"维修中",value:"MAINTENANCE"}),e(c,{label:"离线",value:"OFFLINE"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(r,{type:"primary",onClick:D},{default:t(()=>[...l[17]||(l[17]=[v("搜索",-1)])]),_:1}),e(r,{onClick:A},{default:t(()=>[...l[18]||(l[18]=[v("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),ae((z(),te(P,{data:y.value,style:{width:"100%"}},{default:t(()=>[e(i,{prop:"id",label:"ID",width:"80"}),e(i,{prop:"plateNo",label:"车牌号",width:"120"}),e(i,{prop:"brand",label:"品牌",width:"120"}),e(i,{prop:"model",label:"型号",width:"150"}),e(i,{prop:"vehicleType",label:"类型",width:"100"}),e(i,{prop:"color",label:"颜色",width:"100"}),e(i,{prop:"seats",label:"座位数",width:"100"}),e(i,{prop:"fuelType",label:"燃料类型",width:"120"}),e(i,{prop:"buyDate",label:"购置日期",width:"120"}),e(i,{prop:"status",label:"状态",width:"100"},{default:t(a=>[e(O,{type:q(a.row.status)},{default:t(()=>[v(oe(k(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),e(i,{label:"操作",width:"220",fixed:"right"},{default:t(a=>[e(r,{size:"small",type:"primary",onClick:L=>Y(a.row)},{default:t(()=>[...l[19]||(l[19]=[v(" 编辑 ",-1)])]),_:1},8,["onClick"]),e(r,{size:"small",type:"success",onClick:L=>h(a.row,"IDLE"),disabled:a.row.status==="IDLE"},{default:t(()=>[...l[20]||(l[20]=[v(" 设为空闲 ",-1)])]),_:1},8,["onClick","disabled"]),e(r,{size:"small",type:"danger",onClick:L=>h(a.row,"MAINTENANCE"),disabled:a.row.status==="MAINTENANCE"},{default:t(()=>[...l[21]||(l[21]=[v(" 维修 ",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[J,p.value]]),e(G,{"current-page":n.value.page,"onUpdate:currentPage":l[2]||(l[2]=a=>n.value.page=a),"page-size":n.value.size,"onUpdate:pageSize":l[3]||(l[3]=a=>n.value.size=a),"page-sizes":[10,20,50,100],total:V.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:M,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1}),e(H,{title:E.value,modelValue:b.value,"onUpdate:modelValue":l[14]||(l[14]=a=>b.value=a),width:"500px",onClose:R},{footer:t(()=>[T("div",me,[e(r,{onClick:l[13]||(l[13]=a=>b.value=!1)},{default:t(()=>[...l[22]||(l[22]=[v("取 消",-1)])]),_:1}),e(r,{type:"primary",onClick:$},{default:t(()=>[...l[23]||(l[23]=[v("确 定",-1)])]),_:1})])]),default:t(()=>[e(x,{model:o.value,rules:S,ref_key:"formRef",ref:I,"label-width":"100px"},{default:t(()=>[e(d,{label:"车牌号",prop:"plateNo"},{default:t(()=>[e(_,{modelValue:o.value.plateNo,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.plateNo=a),disabled:!!o.value.id},null,8,["modelValue","disabled"])]),_:1}),e(d,{label:"车辆类型",prop:"vehicleType"},{default:t(()=>[e(_,{modelValue:o.value.vehicleType,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.vehicleType=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"品牌"},{default:t(()=>[e(_,{modelValue:o.value.brand,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.brand=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"型号"},{default:t(()=>[e(_,{modelValue:o.value.model,"onUpdate:modelValue":l[7]||(l[7]=a=>o.value.model=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"颜色"},{default:t(()=>[e(_,{modelValue:o.value.color,"onUpdate:modelValue":l[8]||(l[8]=a=>o.value.color=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"座位数"},{default:t(()=>[e(Q,{modelValue:o.value.seats,"onUpdate:modelValue":l[9]||(l[9]=a=>o.value.seats=a),min:1,max:100},null,8,["modelValue"])]),_:1}),e(d,{label:"燃料类型"},{default:t(()=>[e(U,{modelValue:o.value.fuelType,"onUpdate:modelValue":l[10]||(l[10]=a=>o.value.fuelType=a),placeholder:"请选择燃料类型"},{default:t(()=>[e(c,{label:"汽油",value:"GASOLINE"}),e(c,{label:"柴油",value:"DIESEL"}),e(c,{label:"电动",value:"ELECTRIC"}),e(c,{label:"混合动力",value:"HYBRID"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"购置日期"},{default:t(()=>[e(j,{modelValue:o.value.buyDate,"onUpdate:modelValue":l[11]||(l[11]=a=>o.value.buyDate=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期"},null,8,["modelValue"])]),_:1}),e(d,{label:"GPS设备ID"},{default:t(()=>[e(_,{modelValue:o.value.gpsDeviceId,"onUpdate:modelValue":l[12]||(l[12]=a=>o.value.gpsDeviceId=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},be=W(ve,[["__scopeId","data-v-5f60f3e5"]]);export{be as default};
